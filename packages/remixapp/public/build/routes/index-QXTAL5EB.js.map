{
  "version": 3,
  "sources": ["../../../../header/dist/index.js", "../../../../footer/dist/index.js", "../../../app/routes/index.tsx", "../../../../utils/src/useApi.ts"],
  "sourcesContent": ["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar React = require('react');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nfunction Header() {\r\n    return React__default[\"default\"].createElement(\"header\", null, \"Lern is the original monorepo too!\");\r\n}\n\nexports.Header = Header;\n", "'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar React = require('react');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nfunction Footer() {\r\n    return React__default[\"default\"].createElement(\"footer\", null, \"Footer\");\r\n}\n\nexports[\"default\"] = Footer;\n", "import { useEffect, useState } from \"react\";\n\nimport { Header } from \"header\";\nimport Footer from \"footer\";\nimport { useApi } from \"utils\";\n\n// const url = \"http://localhost:3001/api/weather/city/101030100\";\nconst url = \"https://mdn.github.io/dom-examples/abort-api/sintel.mp4\";\nconst option = {\n  method: \"get\",\n  timeout: 5000,\n};\nexport default function Index() {\n  // const [data, setData] = useState();\n\n  const { data, error, cancel } = useApi(url, option);\n\n  cancel();\n\n  if (error) {\n    console.log(error);\n  }\n  const handleStart = () => {};\n  const handleClick = () => {\n    cancel();\n  };\n  return (\n    <>\n      <Header />\n\n      <div>\n        Content!\n        {data && JSON.stringify(data)}\n      </div>\n      <button onClick={handleStart}>start</button>\n      <button onClick={handleClick}>cancel</button>\n      <Footer />\n    </>\n  );\n}\n", "import { useRef, useState, useCallback, useEffect } from 'react';\n\n// \u5B9A\u4E49http\u8BF7\u6C42\u7C7B\u578B\nexport type Method = \"get\" | \"delete\" | \"head\" | \"options\" | \"post\" | \"put\" | \"patch\";\n\n// \u5B9A\u4E49\u4E00\u4E2Atype\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u83B7\u53D6\u5BF9\u8C61\u7684key\u7C7B\u578B\nexport type IndexedType<T> = {\n  [key: string]: T\n}\n\n// \u8BF7\u6C42\nexport type BaseRawReq = IndexedType<unknown>;\nexport type BaseReq = IndexedType<unknown>;\n// \u54CD\u5E94\nexport type BaseRawRes = IndexedType<unknown>;\nexport type BaseRes = IndexedType<unknown>;\n\nexport type Option = {\n  method: Method;\n  timeout?: number;\n  debounce?: {\n    wait: number;\n    leading: boolean;\n    trailing: boolean\n  }\n}\n\n\n// \u6838\u5FC3\u65B9\u6CD5\uFF0C\nexport const useApi = (url: string, option: Option) => {\n  const [data, setData] = useState<Response>();\n  const [error, setError] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  // \u7528\u6765\u53D6\u6D88\u8BF7\u6C42\n  const abortRef = useRef<AbortController | null>(null);\n\n  const cancel = () => {\n    console.log(\"\u6211\u88AB\u6267\u884C\u4E86...\")\n    if (abortRef.current) {\n      abortRef.current.abort();\n      abortRef.current = null;\n    }\n  }\n\n  // const _request = useCallback(\n  //   async () => {\n  //     cancel();\n  //     const controller = new AbortController();\n  //     const signal = controller.signal;\n  //     abortRef.current = controller;\n  //     try {\n  //       Promise.race([\n  //         new Promise<Response>((_, reject) => {\n  //           setTimeout(\n  //             () => reject(`\u8BF7\u6C42\u8D85\u65F6: ${url}`),\n  //             option?.timeout || 1000);\n  //         }),\n  //         fetch(url, {\n  //           ...option,\n  //           method: option.method || \"get\",\n  //           signal\n  //         })\n  //       ]).then(res => res.json())\n  //         .then(data => {\n  //           setData(data);\n  //           setIsLoading(false)\n  //         }).catch((e) => {\n  //           throw e;\n  //         })\n  //     } catch (err: any) {\n  //       console.error(err);\n  //       // \u81EA\u5DF1\u53D6\u6D88\u7684\u8BF7\u6C42\uFF0C\u4E0D\u8BBE\u7F6Eerror\n  //       if (err.name !== 'AbortError') {\n  //         setError(err);\n  //       }\n  //       throw err;\n  //     }\n  //   },\n  //   [url, option],\n  // )\n\n\n  const _request = useCallback(\n    async () => {\n      cancel();\n      const controller = new AbortController();\n      const signal = controller.signal;\n      abortRef.current = controller;\n\n      fetch(url, {\n        ...option,\n        method: option.method || \"get\",\n        signal\n      }).then(res => res.json())\n        .then(data => {\n          setData(data);\n          setIsLoading(false)\n        }).catch((e) => {\n          throw e;\n        })\n    },\n    [url, option],\n  )\n\n  useEffect(() => {\n    _request();\n  }, [_request])\n\n  return {\n    data,\n    error,\n    isLoading,\n    cancel\n  }\n\n}"],
  "mappings": "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",
  "names": ["Header", "require_dist", "Footer", "url", "option", "data", "Footer"]
}
